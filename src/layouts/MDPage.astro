---
import Layout from "./Layout.astro";
import { formatDate, getCoverImage } from "@utils/utils";

const { frontmatter, headings } = Astro.props;
---

<Layout title={frontmatter.title}>
  <section
    id="pageContent"
    class="bg-stone-100 shadow-lg prose-h2:mt-4 prose-h3:mt-4 p-8 border border-stone-200 rounded-lg max-w-none text-base/8 prose prose-stone">
    <header class="mb-6">
      <h1 class="mb-1">{frontmatter.title}</h1>
      <div class="text-stone-600 text-sm">
        {frontmatter.date && formatDate(frontmatter.date)}
      </div>

      {
      frontmatter.cover &&
        <div class="sm:rounded-md coverImage" set:html={getCoverImage(frontmatter)}/>
      }
    </header>

    {
      frontmatter.toc == true && headings.length > 0 && (
        <div
          id="toc"
          class="bg-stone-100 mb-6 border-stone-300 border-b">
          <div class="mb-2">Inhaltsverzeichnis</div>
          <ul class="flex flex-wrap items-center gap-x-2 pb-4 not-prose">
            {headings.map((heading: { slug: string; text: string }) => (
              <li class="toc-item">
                <a href={`#${heading.slug}`} class="text-sky-600 hover:text-sky-700 hover:underline">{heading.text}</a>
              </li>
              <li class="text-stone-400">&vert;</li>
            ))}
          </ul>
        </div>
      )
    }
    <slot />
  </section>
</Layout>

<style is:global>
  h2,
  h3 {
    scroll-margin-top: 1rem;
  }

  .coverImage {
    display: flex;
    justify-content: center;

  }

  .coverImage img {
    border-radius: 8px;
    border: 1px solid var(--color-zinc-200);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    width: 100%; /* Ensures the image scales down */
    height: auto; /* Maintains aspect ratio */
  }

</style>
