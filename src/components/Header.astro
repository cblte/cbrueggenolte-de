---
import ThemeIcon from '@components/ThemeIcon.astro';
import { headerMenu } from '@utils/menu';

// Normalize URL path by ensuring trailing slash
const normalizeUrl = (url: string) => (url.endsWith('/') ? url : url + '/');
const activePage = normalizeUrl(Astro.url.pathname);
---

<header class="flex md:flex-row flex-col md:justify-between md:items-center gap-4 mx-auto mt-16 mb-8 px-6 max-w-5xl">
  <!-- Top row on mobile: Logo and Theme Icon -->
  <div class="flex md:flex-shrink-0 uppercase">
    <a href="/" target="_self" class="flex items-center gap-4 text-lg lg:text-2xl">
      <div class="w-12 lg:w-16 h-12 lg:h-16">
        <img
          src="/images/about-me-aipg.jpg"
          alt="A AI generate picture of Carsten Brüggenolte"
          width="1024"
          height="1024"
          loading="lazy"
          decoding="async"
          class="shadow-lg border-2 border-stone-100 rounded-lg w-full h-full object-cover"
        />
      </div>
      <div class="leading-tight">
        <div class="inline text-green-500">C</div>arsten<br />
        <div class="inline text-green-500">B</div>rüggenolte
      </div>
    </a>
  </div>

  <!-- Navigation - full width on mobile, center on desktop -->
  <nav class="flex justify-end w-full">
    <ul class="flex flex-wrap md:items-center gap-4 md:gap-4 text-xl">
      {
        headerMenu.map((item, index) => (
          <li class="inline-block">
            <a
              href={item.href}
              target="_self"
              class={`${activePage === item.href ? 'text-stone-200 underline font-medium' : ''} hover:underline px-3 py-2 text-green-500 transition duration-200`}>
              {item.name}
            </a>
          </li>
        ))
      }
    </ul>
  </nav>
</header>
